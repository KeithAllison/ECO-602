---
title: "Using Models 1"
author: "Keith Allison"
date: "11/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
catrate <- read.csv("data/catrate.csv")
```


# Q1 Catastrophic Rate Histogram

```{r}
hist(catrate$cat.rate, xlab = "Catastrophe rate", main = "Histogram of Catastrophe rate")
```
# Q2 Normality test

```{r}
shapiro.test(catrate$cat.rate)
```
The p-value is 0.04097

# Q3 Normality Test

The null hypothesis for the Shapiro test is that the data is normally distributed.

# Q4 Normality Test

The low p-value (0.04097) suggests that there is strong evidence that the data came from non-normal distribution.


# Q5 T-Test 1

```{r}
t.test(catrate$cat.rate, mu = 2/7)
```

# Q6 T-Test 1

The null hypothesis is that the true mean of cat.rate is equal to 2/7, the pond late-filling rate.

# Q7 T-Test 1

This is a two-tailed test.

# Q8 T-Test 2

The p-value is 0.01193 which means that there is a 1.193% chance that the result of the test (to reject the null hypothesis) is a false positive.

# Q9 T-Test 2

The 95% confidence interval is 0.353 to 0.726 which means that the true mean is between 0.353 and 0.726 at a 95% confidence level.This confidence interval did not include 0.

# Q10 T-Test 2

The t-test gave a p-value of 0.01193 which is low. This suggests that the null hypothesis (that the true mean of cat.rate is 2/7) should be rejected.


# Q11 Wilcoxon Test 1

```{r}
wilcox.test(catrate$cat.rate, mu = 2 / 7)
```
# Q12 Wilcoxon Test 1

The p-value for the Wilcoxon test is lower than the p-value for the t-test.

# Q13 Wilcoxon Test 1

The test gave a p-value of 0.006275 which is low and gives strong evidence to reject the null hypothesis.

# Q14 Test Comparisons

Both tests led to the same conclusion, we reject the null hypothesis that the true mean of the cat.rate is equal to 2/7.

# Q15 Test Comparisons

The Wilcoxon rank sum test is more appropriate for these data because the Shapiro test tells us that the data is not normally distributed. The Wilcoxon test is a non-parametric test while Student's t test requires the data to be normally distributed.


# Q16 Flippers - Normality Tests

```{r}
require(palmerpenguins)
data(penguins)
penguin_dat = droplevels(subset(penguins, species != "Gentoo"))
```
```{r}
dat_adelie <- subset(penguin_dat, species == "Adelie")
dat_chinstrap <- subset(penguin_dat, species == "Chinstrap")

shapiro.test(dat_adelie$flipper_length_mm)
shapiro.test(dat_chinstrap$flipper_length_mm)
```
# Q17 Flippers - Normality Tests

The p-values for adelie flipper length (0.72) and chinstrap flipper length (0.8106) are both high. Therefore we fail to reject the null hypothesis that the flipper lengths for both species are normally distributed. 


# Q18 Flippers- Histograms

```{r}
par(mfrow=c(1,2))
hist(dat_adelie$flipper_length_mm, main = "Adelie flipper length", xlab = "Flipper Length (mm)")
hist(dat_chinstrap$flipper_length_mm, main = "Chinstrap flipper length", xlab = "Flipper Length (mm)")
```


# Q19 Flippers T-Test

The alternate hypothesis of the test is that the difference between the mean flipper length of Adelie penguins and the mean flipper length of Chinstrap penguins is not equal to 0.



# Q20 Flippers T-test

```{r}
t.test(flipper_length_mm ~ species, mu =0, data = penguin_dat)
```